package main

import (
	"fmt"
	"regexp"
	"strings"
)

func main() {
	//var emojiRx = regexp.MustCompile(`[\x{1F600}-\x{1F6FF}|[\x{2600}-\x{26FF}]|[💪]|[❤️]|[🔥]|[🤗]|[👏]|[💞]|[🌻]|[🌺]|[🕊💐|[💯]|[🤘]|[👌]|[💛]|[🥁]|[🎹]|[🤙]|[🤩]|[👇]|[🌟]|[💜]|[💚]|[🥰]|[💦]|[🤦]|[👈]|[🕺]|[💃]|[💖]|[💕]|[✊]|[🏏]|[🎼]|[🗿]|[🎉]|[📸]|[🎊]|[🗣]|[💙]|[👍]|[💥]| [🤔]| [🥳] |[💟]|[🌪]|[🥛] | [💋] | [💏]| [🏃]|[⭐]|[👊]|[🤛]|[💥]|[🎂]|[✌🏻]|[🤣]|[👉]|[🤕]|[💓]|[🤝]|[🇸🇻]|[✅]|[🤮]|[🍬]|[🌹]|[✍🏻]|[✨]|[🎬]|[❓]|[👐]|[🍺]|[🗝]|[👃]|[🖕]|[🔀]|[]🏽]|[📢]|[]🏾]|[🤬]|[🤟]|[👅]|[🌼]|[🤪]|[🤷]|[🌸]|[🧡]|[🤧]|[💝]|[🤫]|[]🏼]|[💫]|[💗]|[🍌]|[🍼]|[👸]|[🍻]|[💰]|[💵]|[🤯]|[🤐]|[📣]|[🌃]|[💑]|[🌃]|[👑]|[🤭]|[🎤]|[🖌]|[🦁]|[👀]|[🤡]|[🌬]|[🤞]|[🤒]|[🏥]|[👩]|[👨]|[💉]|[💊]|[👨‍👨‍👧‍👦]|[🍉]|[🇲🇾]|[💔]|[👫]|[🥺]|[🎶]|[▶]|[•]|[💘]|[🤑]|[🥳]|[🇮🇳]|[🤤]|[🤔]|[🏃]|[🎻]|[🎸]|[📯]|[🎺]|[🎵]|[🌞]|[🥛]|[💎]|[🌄]|[🤓]|[➡]|[✖]|[►]|[❣]|[👋]|[📷]|[💨]|[🔟]|[🎈]|[🤴]|[🎯]|[🌷]|[🌷]|[👪]|[ 💤]|[🌙]|[🌠]|[🤢]|[👄]|[💻]|[💿]|[]🏿]|[👽]|[🌋]|[❌]|[🐉]|[💆]|[👼]|[🍀]|[⏳]|[🎁]|[🎇]|[🏆]|[🥂]|[🤥]|[💁]|[🔯]|[👎]|[🎷]|[🥵]|[🕯]|[👖]|[👱]|[👥]|[🌧]|[👗]|[👬]|[🎆]|[🆚]|[🏄]|[🔊]|[🎙]|[✋]|[🔔]|[🔯]|[👁]|[🏆]|[🍫]|[🥃]|[🏠]|[🍨]|[🍧]|[🥧]|[🍰]|[🐒]|[🐿]|[👼]|[🇧🇩]|[🐕]|[👿]|[🌊]|[🏪]|[🌿]|[🌱]|[🖐]|[🤜]|[🎋]|[🍾]|[🍷]|[🤳]|[🍴]|[🗑]|[🥴]|[👆]|[🔇]|[🐑]|[🇦🇺]|[🐵]|[🐶]|[🦋]|[🔞]|[🔃]|[💸]|[🤸]|[🍭]|[🌊]|[📦]|[🍷]|[🍸]|[🍹]|[🔱]|[🔄]|[🎽]|[🏀]|[💀]|[🎃]|[🏡]|[🐖]|[🐷]|[🐯]|[🐍]|[🌲]|[🐝]|[💧]|[🏋]|[🤺]|[🖐]|[👶]|[🌤]|[🅰]|[🔞]|[🤚]|[🐻]|[💋]|[📽]|[🏭]|[🌁]|[🏗]|[🏪]|[🏩]|[🇹🇹]|[🔫]|[💭]|[🍆]|[🍦]|[🔸]|[📌]|[🔨]|[🥚]|[🤲]|[💭]|[🥇]|[🤨]|[🏟]`)
	//var emojiRx = regexp.MustCompile(`[\x{1F600}-\x{1F6FF}|[\x{2600}-\x{26FF}]|[💪]|[❤️]|[🔥]|[🤗]|[👏]|[💞]|[🌻]|[🌺]|[🕊💐|[💯]|[🤘]|[👌]|[💛]|[🥁]|[🎹]|[🤙]|[🤩]|[👇]|[🌟]|[💜]|[💚]|[🥰]|[💦]|[🤦]|[👈]|[🕺]|[💃]|[💖]|[💕]|[✊]|[🏏]|[🎼]|[🗿]|[🎉]|[📸]|[🎊]|[🗣]|[💙]|[👍]|[💥]| [🤔]| [🥳] |[💟]|[🌪]|[🥛] | [💋] | [💏]| [🏃]|[⭐]|[👊]|[🤛]|[💥]|[🎂]|[✌🏻]|[🤣]|[👉]|[🤕]|[💓]|[🤝]|[🇸🇻]|[✅]|[🤮]|[🍬]|[🌹]|[✍🏻]|[✨]|[🎬]|[❓]|[👐]|[🍺]|[🗝]|[👃]|[🖕]|[🔀]|[]🏽]|[📢]|[]🏾]|[🤬]|[🤟]|[👅]|[🌼]|[🤪]|[🤷]|[🌸]|[🧡]|[🤧]|[💝]|[🤫]|[]🏼]|[💫]|[💗]|[🍌]|[🍼]|[👸]|[🍻]|[💰]|[💵]|[🤯]|[🤐]|[📣]|[🌃]|[💑]|[🌃]|[👑]|[🤭]|[🎤]|[🖌]|[🦁]|[👀]|[🤡]|[🌬]|[🤞]|[🤒]|[🏥]|[👩]|[👨]|[💉]|[💊]|[👨‍👨‍👧‍👦]|[🍉]|[🇲🇾]|[💔]|[👫]|[🥺]|[🎶]|[▶]|[•]|[💘]|[🤑]|[🥳]|[🇮🇳]|[🤤]|[🤔]|[🏃]|[🎻]|[🎸]|[📯]|[🎺]|[🎵]|[🌞]|[🥛]|[💎]|[🌄]|[🤓]|[➡]|[✖]|[►]|[❣]|[👋]|[📷]|[💨]|[🔟]|[🎈]|[🤴]|[🎯]|[🌷]|[🌷]|[👪]|[ 💤]|[🌙]|[🌠]|[🤢]|[👄]|[💻]|[💿]|[]🏿]|[👽]|[🌋]|[❌]|[🐉]|[💆]|[👼]|[🍀]|[⏳]|[🎁]|[🎇]|[🏆]|[🥂]|[🤥]|[💁]|[🔯]|[👎]|[🎷]|[🥵]|[🕯]|[👖]|[👱]|[👥]|[🌧]|[👗]|[👬]|[🎆]|[🆚]|[🏄]|[🔊]|[🎙]|[✋]|[🔔]|[🔯]|[👁]|[🏆]|[🍫]|[🥃]|[🏠]|[🍨]|[🍧]|[🥧]|[🍰]|[🐒]|[🐿]|[👼]|[🇧🇩]|[🐕]|[👿]|[🌊]|[🏪]|[🌿]|[🌱]|[🖐]|[🤜]|[🎋]|[🍾]|[🍷]|[🤳]|[🍴]|[🗑]|[🥴]|[👆]|[🔇]|[🐑]|[🇦🇺]|[🐵]|[🐶]|[🦋]|[🔞]|[🔃]|[💸]|[🤸]|[🍭]|[🌊]|[📦]|[🍷]|[🍸]|[🍹]|[🔱]|[🔄]|[🎽]|[🏀]|[💀]|[🎃]|[🏡]|[🐖]|[🐷]|[🐯]|[🐍]|[🌲]|[🐝]|[💧]|[🏋]|[🤺]|[🖐]|[👶]|[🌤]|[🅰]|[🔞]|[🤚]|[🐻]|[💋]|[📽]|[🏭]|[🌁]|[🏗]|[🏪]|[🏩]|[🇹🇹]|[🔫]|[💭]|[🍆]|[🍦]|[🔸]|[📌]|[🔨]|[🥚]|[🤲]|[💭]|[🥇]|[🤨]|[🏟]`)
	var emojiRx = regexp.MustCompile(`[\x{1F600}-\x{1F6FF}|[\x{2600}-\x{26FF}]|[🏃]|[💋]|[💏]|[🤔]|[🥳]|[💤]|[]🏼]|[]🏽]|[]🏾]|[]🏿]|[•]|[⏳]|[▶]|[►]|[✅]|[✊]|[✋]|[✌🏻]|[✍🏻]|[✖]|[✨]|[❌]|[❓]|[❣]|[❤️]|[➡]|[⭐]|[🅰]|[🆚]|[🇦🇺]|[🇧🇩]|[🇮🇳]|[🇲🇾]|[🇸🇻]|[🇹🇹]|[🌁]|[🌃]|[🌃]|[🌄]|[🌊]|[🌊]|[🌋]|[🌙]|[🌞]|[🌟]|[🌠]|[🌤]|[🌧]|[🌪]|[🌬]|[🌱]|[🌲]|[🌷]|[🌷]|[🌸]|[🌹]|[🌺]|[🌻]|[🌼]|[🌿]|[🍀]|[🍆]|[🍉]|[🍌]|[🍦]|[🍧]|[🍨]|[🍫]|[🍬]|[🍭]|[🍰]|[🍴]|[🍷]|[🍷]|[🍸]|[🍹]|[🍺]|[🍻]|[🍼]|[🍾]|[🎁]|[🎂]|[🎃]|[🎆]|[🎇]|[🎈]|[🎉]|[🎊]|[🎋]|[🎙]|[🎤]|[🎬]|[🎯]|[🎵]|[🎶]|[🎷]|[🎸]|[🎹]|[🎺]|[🎻]|[🎼]|[🎽]|[🏀]|[🏃]|[🏄]|[🏆]|[🏆]|[🏋]|[🏏]|[🏗]|[🏟]|[🏠]|[🏡]|[🏥]|[🏩]|[🏪]|[🏪]|[🏭]|[🐉]|[🐍]|[🐑]|[🐒]|[🐕]|[🐖]|[🐝]|[🐯]|[🐵]|[🐶]|[🐷]|[🐻]|[🐿]|[👀]|[👁]|[👃]|[👄]|[👅]|[👆]|[👇]|[👈]|[👉]|[👊]|[👋]|[👌]|[👍]|[👎]|[👏]|[👐]|[👑]|[👖]|[👗]|[👥]|[👨]|[👨‍👨‍👧‍👦]|[👩]|[👪]|[👫]|[👬]|[👱]|[👶]|[👸]|[👼]|[👼]|[👽]|[👿]|[💀]|[💁]|[💃]|[💆]|[💉]|[💊]|[💋]|[💎]|[💐]|[💑]|[💓]|[💔]|[💕]|[💖]|[💗]|[💘]|[💙]|[💚]|[💛]|[💜]|[💝]|[💞]|[💟]|[💥]|[💥]|[💦]|[💧]|[💨]|[💪]|[💫]|[💭]|[💭]|[💯]|[💰]|[💵]|[💸]|[💻]|[💿]|[📌]|[📢]|[📣]|[📦]|[📯]|[📷]|[📸]|[📽]|[🔀]|[🔃]|[🔄]|[🔇]|[🔊]|[🔔]|[🔞]|[🔞]|[🔟]|[🔥]|[🔨]|[🔫]|[🔯]|[🔯]|[🔱]|[🔸]|[🕊]|[🕯]|[🕺]|[🖌]|[🖐]|[🖐]|[🖕]|[🗑]|[🗝]|[🗣]|[🗿]|[🤐]|[🤑]|[🤒]|[🤓]|[🤔]|[🤕]|[🤗]|[🤘]|[🤙]|[🤚]|[🤛]|[🤜]|[🤝]|[🤞]|[🤟]|[🤡]|[🤢]|[🤣]|[🤤]|[🤥]|[🤦]|[🤧]|[🤨]|[🤩]|[🤪]|[🤫]|[🤬]|[🤭]|[🤮]|[🤯]|[🤲]|[🤳]|[🤴]|[🤷]|[🤸]|[🤺]|[🥁]|[🥂]|[🥃]|[🥇]|[🥚]|[🥛]|[🥛]|[🥧]|[🥰]|[🥳]|[🥴]|[🥵]|[🥺]|[🦁]|[🦋]|[🧡]|[🦸]`)

	//	urlexp := regexp.MustCompile(`^(?:https?:\/\/)?(?:[^@\/\n]+@)?(?:www\.)?([^:\/\n]+)`)

	//urlexp := regexp.MustCompile(`(?P<url>https?://[^\s]+)`)
	urlexp2 := regexp.MustCompile(`(?P<url>https?.+)`)
	twitterHandleExp := regexp.MustCompile(`@([A-Za-z]+[A-Za-z0-9-_]+)`)
	hashtagHandleExp := regexp.MustCompile(`#([A-Za-z]+[A-Za-z0-9-_]+)`)
	hashtagHandleExp2 := regexp.MustCompile(`@(_*[0-9]*_*[A-Za-z]+[A-Za-z0-9-_]+)`)


	
	newLineRegExp := regexp.MustCompile(`\n`)

	count := 0
	saved := 0
	duplicate := 0

	for i := 0; i <= 61098; i++ {
		record := getCurrentTweet(int64(i))
		if record.Class != "" { //&& !strings.Contains(record.Class, "J") {

			printString := emojiRx.ReplaceAllString(record.Tweet, `[e]`)
			printString = urlexp2.ReplaceAllString(printString, `[LINK]`)
			printString = twitterHandleExp.ReplaceAllString(printString, `[USERNAME]`)
			printString = hashtagHandleExp.ReplaceAllString(printString, `[HASHTAG]`)
			printString = hashtagHandleExp2.ReplaceAllString(printString, `[HASHTAG]`)
			printString = strings.ToLower(printString)
			printString = newLineRegExp.ReplaceAllString(printString, ``)
			fmt.Printf("%d - %s - %s\n", record.Id, printString, record.Class)
			record.Tweet = fmt.Sprintf("%s", printString)
			record.Class = strings.TrimSpace(record.Class)
			//			fmt.Printf("--%s-- %d \n", record.Class, len(record.Class))
			if saveNormalizedTweet(record) {
				saved++
			} else {
				duplicate++
			}

			count++
		}
	}

	fmt.Println("The total count is ", count)
	fmt.Println("The saved count is ", saved)
	fmt.Println("The duplicate count is ", duplicate)
}
